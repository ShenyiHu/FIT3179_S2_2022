{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/ShenyiHu/FIT3179_S2_2022/main/Data_Visualisation_2/data/users_speed_prices.csv"
  },
  "config": {
    "axis": {
      "labelFont": "Monaco",
      "titleFont": "Monaco"
    },
    "legend": {
      "labelFont": "Monaco",
      "titleFont": "Monaco"
    },
    "header": {
      "labelFont": "Monaco",
      "titleFont": "Monaco"
    },
    "mark": {
      "font": "Monaco"
    },
    "title": {
      "font": "Monaco",
      "subtitleFont": "Monaco"
    }
  },
  "params": [
    {
      "name": "Population_Above",
      "value": 0,
      "bind": {
        "input": "range",
        "min": 0,
        "max": 100000000,
        "step": 1000000,
        "name": "Minimum Population: "
      }
    },
    {
      "name": "Continent_selection",
      "bind": {
        "input": "select",
        "options": [
          null,
          "Americas",
          "Europe",
          "Africa",
          "Asia",
          "Oceania"
        ],
        "labels": [
          "Show All",
          "Americas",
          "Europe",
          "Africa",
          "Asia",
          "Oceania"
        ],
        "name": "Continent Selection: "
      }
    }
  ],
  "transform": [
    {
      "filter": "datum.Users > 0"
    },
    {
      "filter": "datum.Speed > 0"
    },
    {
      "filter": "datum.Population > Population_Above"
    },
    {
      "filter": "Continent_selection == null || datum.Continent == Continent_selection"
    },
    {
      "calculate": "datum.Users/datum.Population * 10000",
      "as": "Users per 10,000 Population"
    }
  ],
  "title": "Global Internet Users and Speed (Mbps) in 2022",
  "vconcat": [
    {
      "width": "container",
      "height": 500,
      "encoding": {
        "x": {
          "field": "Users",
          "type": "quantitative",
          "title": "Internet Users",
          "axis": {
            "tickCount": 3
          },
          "scale": {
            "type": "log",
            "domain": [
              100000,
              1200000000
            ]
          }
        },
        "y": {
          "field": "Speed",
          "type": "quantitative"
        }
      },
      "layer": [
        {
          "mark": "point",
          "encoding": {
            "size": {
              "field": "Population",
              "type": "quantitative",
              "scale": {
                "type": "threshold",
                "domain": [
                  1000000,
                  10000000,
                  50000000,
                  100000000,
                  500000000
                ],
                "range": [
                  10,
                  50,
                  150,
                  200,
                  300,
                  400
                ]
              },
              "legend": {
                "format": ".1s"
              }
            },
            "shape": {
              "field": "Continent",
              "type": "nominal",
              "scale": {
                "domain": [
                  "Americas",
                  "Europe",
                  "Africa",
                  "Asia",
                  "Oceania"
                ],
                "range": [
                  "circle",
                  "square",
                  "triangle-down",
                  "diamond",
                  "triangle-up"
                ]
              }
            },
            "opacity": {
              "value": 0.6
            },
            "tooltip": [
              {
                "field": "Country",
                "type": "nominal"
              },
              {
                "field": "Users",
                "type": "quantitative",
                "format": ","
              },
              {
                "field": "Population",
                "type": "quantitative",
                "format": ","
              },
              {
                "field": "Users per 10,000 Population",
                "type": "quantitative",
                "format": ".2f"
              },
              {
                "field": "Speed",
                "type": "quantitative",
                "format": ","
              }
            ]
          }
        },
        {
          "mark": {
            "type": "text",
            "align": "right",
            "baseline": "middle",
            "dx": -12,
            "fontSize": 11.5,
            "fontStyle": "italic",
            "font": "Monaco"
          },
          "encoding": {
            "text": {
              "field": "Country",
              "type": "nominal"
            },
            "color": {
              "value": "black"
            },
            "opacity": {
              "condition": {
                "test": "datum['Country'] == 'China' || datum['Country'] == 'India' || datum['Country'] == 'Malaysia' || datum['Country'] == 'Australia' || datum['Country'] == 'New Zealand' || datum['Country'] == 'United States'",
                "value": 1
              },
              "value": 0
            },
            "tooltip": [
              {
                "field": "Country",
                "type": "nominal"
              },
              {
                "field": "Users",
                "type": "quantitative",
                "format": ","
              },
              {
                "field": "Population",
                "type": "quantitative",
                "format": ","
              },
              {
                "field": "Users per 10,000 Population",
                "type": "quantitative",
                "format": ".2f"
              },
              {
                "field": "Speed",
                "type": "quantitative",
                "format": ","
              }
            ]
          }
        }
      ]
    },
    {
      "width": "container",
      "height": 500,
      "mark": "line",
      "encoding": {
        "x": {
          "field": "Year",
          "type": "nominal"
        },
        "y": {
          "field": "Price",
          "type": "quantitative"
        },
        "color": {
          "field": "Country",
          "type": "nominal"
        }
      }
    }
  ]
}